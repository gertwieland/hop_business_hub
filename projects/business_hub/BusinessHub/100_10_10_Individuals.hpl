<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>100_10_10_Individuals</name>
    <name_sync_with_filename>Y</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <pipeline_status>0</pipeline_status>
    <parameters>
      <parameter>
        <name>n1</name>
        <default_value>8</default_value>
        <description/>
      </parameter>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>gert</created_user>
    <created_date>2022/02/22 16:39:07.390</created_date>
    <modified_user>gert</modified_user>
    <modified_date>2023/04/18 13:52:07.437</modified_date>
  </info>
  <notepads>
    <notepad>
      <backgroundcolorblue>251</backgroundcolorblue>
      <backgroundcolorgreen>232</backgroundcolorgreen>
      <backgroundcolorred>201</backgroundcolorred>
      <bordercolorblue>90</bordercolorblue>
      <bordercolorgreen>58</bordercolorgreen>
      <bordercolorred>14</bordercolorred>
      <fontbold>N</fontbold>
      <fontcolorblue>90</fontcolorblue>
      <fontcolorgreen>58</fontcolorgreen>
      <fontcolorred>14</fontcolorred>
      <fontitalic>N</fontitalic>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <height>38</height>
      <xloc>1616</xloc>
      <yloc>464</yloc>
      <note>Once in production, we can limit to only recently updated records.
Consider a full update once a month or so.</note>
      <width>303</width>
    </notepad>
  </notepads>
  <order>
    <hop>
      <from>Select values</from>
      <to>Employee</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lookup Criteria</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Current Employee Status</from>
      <to>Employee Status Reason</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Employee</from>
      <to>Employee Position</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Employee Position</from>
      <to>HR Position</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Employee Status Reason</from>
      <to>Employee Type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>If field value is null</from>
      <to>Select values 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Modified JavaScript value 2</from>
      <to>EmploymentCategory</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>HR Status Reason Type</from>
      <to>HR LOCATION</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort rows</from>
      <to>Add value fields changing sequence</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add value fields changing sequence</from>
      <to>Filter rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter rows</from>
      <to>Select values 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort rows 2</from>
      <to>Add value fields changing sequence 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 5</from>
      <to>Stream lookup 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>HR LOCATION</from>
      <to>Stream lookup</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 4</from>
      <to>Stream lookup</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Stream lookup</from>
      <to>Stream lookup 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Stream lookup 2</from>
      <to>ReportTo_Details</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add value fields changing sequence 2</from>
      <to>Filter rows 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Filter rows 2</from>
      <to>Select values 5</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>String operations</from>
      <to>Replace in string</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 3</from>
      <to>Insert / update</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 2</from>
      <to>Modified JavaScript value 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>HR Position</from>
      <to>HR Job Detail</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>HR Job Detail</from>
      <to>Current Employee Status</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Employee Type</from>
      <to>HR Status Reason Type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get system info</from>
      <to>Select values 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>EmploymentCategory</from>
      <to>Is Employee?</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Is Employee?</from>
      <to>String operations</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Replace in string</from>
      <to>Add a checksum</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add a checksum</from>
      <to>Lookup Existing ChangeFlag</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lookup Existing ChangeFlag</from>
      <to>Changed/ new records</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Changed/ new records</from>
      <to>Get system info</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Stream lookup 3</from>
      <to>If field value is null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Individual</from>
      <to>Lookup Criteria</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>BPL_HR_EMPLOYEE_POSITION_DIM</from>
      <to>Sort rows</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>EDW_HR_EMPLOYEE_POSITION</from>
      <to>Sort rows 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Dummy (do nothing) 2</from>
      <to>Stream lookup 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>EMPLOYEEEMAILADDRESS</from>
      <to>Dummy (do nothing) 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>ReportTo_Details</from>
      <to>Stream lookup 4</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Stream lookup 4</from>
      <to>Stream lookup 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Find ENID by EmployeeID</from>
      <to>Stream lookup 4</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>Add a checksum</name>
    <type>CheckSum</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <checksumtype>SHA-256</checksumtype>
    <fields>
      <field>
        <name>APPLICATION_LAST_ACTIVITY_DATE</name>
      </field>
      <field>
        <name>AssignmentType_Position</name>
      </field>
      <field>
        <name>BenefitGroupCode_Position</name>
      </field>
      <field>
        <name>CANADIAN_CITIZEN_INDICATOR</name>
      </field>
      <field>
        <name>COMMUNICATION_LANGUAGE_CODE</name>
      </field>
      <field>
        <name>COMPENSATION_GROUP_CODE</name>
      </field>
      <field>
        <name>CREATE_DATE</name>
      </field>
      <field>
        <name>CREA_TS</name>
      </field>
      <field>
        <name>CURRENT_RECORD_INDICATOR</name>
      </field>
      <field>
        <name>DATE_OF_BIRTH</name>
      </field>
      <field>
        <name>ENID</name>
      </field>
      <field>
        <name>Email</name>
      </field>
      <field>
        <name>EmployeeTypeCode_Position</name>
      </field>
      <field>
        <name>EmployeeType_Explanation</name>
      </field>
      <field>
        <name>EmployeeType_Text</name>
      </field>
      <field>
        <name>Employee_ID</name>
      </field>
      <field>
        <name>FIRST_NAME</name>
      </field>
      <field>
        <name>FullTimeIndicator_Position</name>
      </field>
      <field>
        <name>FullTimePercent_Position</name>
      </field>
      <field>
        <name>GENDER_CODE</name>
      </field>
      <field>
        <name>INDIVIDUAL_EFFECTIVE_DATE</name>
      </field>
      <field>
        <name>INDIVIDUAL_EXPIRY_DATE</name>
      </field>
      <field>
        <name>INDIVIDUAL_ID</name>
      </field>
      <field>
        <name>INITIALS</name>
      </field>
      <field>
        <name>JOB_DETAIL_NAME_ENGLISH</name>
      </field>
      <field>
        <name>JobNumber</name>
      </field>
      <field>
        <name>LAST_UPD_TS</name>
      </field>
      <field>
        <name>LOCATION_CODE</name>
      </field>
      <field>
        <name>LOCATION_ENGLISH_NAME</name>
      </field>
      <field>
        <name>LOOKUP_HR_JOB_DETAIL_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_HR_POSITION_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_STATUS_POSITION_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_STATUS_REASON_CODE_CURRENT</name>
      </field>
      <field>
        <name>LastHireDate</name>
      </field>
      <field>
        <name>OTHER_CITIZEN_COUNTRY_CODE</name>
      </field>
      <field>
        <name>OriginalHireDate</name>
      </field>
      <field>
        <name>POSITION_NAME_ONE</name>
      </field>
      <field>
        <name>POSITION_NAME_TWO</name>
      </field>
      <field>
        <name>PermanentIndicator_Position</name>
      </field>
      <field>
        <name>PositionCode</name>
      </field>
      <field>
        <name>ReasonCode_Position</name>
      </field>
      <field>
        <name>ReportTo_FirstName</name>
      </field>
      <field>
        <name>ReportTo_Individual_ID</name>
      </field>
      <field>
        <name>ReportTo_LastName</name>
      </field>
      <field>
        <name>SALUTATION_CODE</name>
      </field>
      <field>
        <name>STATUS_REASON_CODE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_CURRENT_ENGLISH</name>
      </field>
      <field>
        <name>STATUS_REASON_EXPLANATION_ONE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_TYPE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_TYPE_ENGLISH</name>
      </field>
      <field>
        <name>SURNAME</name>
      </field>
      <field>
        <name>TrialEndDate_Position</name>
      </field>
      <field>
        <name>UPDATE_DATE</name>
      </field>
      <field>
        <name>USUAL_FIRST_NAME</name>
      </field>
      <field>
        <name>UpdateType_Position</name>
      </field>
      <field>
        <name>Employee_FirstName</name>
      </field>
      <field>
        <name>Employee_LastName</name>
      </field>
      <field>
        <name>Employee_FirstLastName</name>
      </field>
      <field>
        <name>Employee_LastFirstName</name>
      </field>
      <field>
        <name>IsOnLeaveOfAbsence</name>
      </field>
      <field>
        <name>IsTerminated</name>
      </field>
      <field>
        <name>IsFullTime</name>
      </field>
      <field>
        <name>IsPermanent</name>
      </field>
      <field>
        <name>EmploymentStatus</name>
      </field>
      <field>
        <name>EmploymentStatus_NoOfRules</name>
      </field>
      <field>
        <name>EmploymentStatus_SortOrder</name>
      </field>
      <field>
        <name>IsEmployee</name>
      </field>
    </fields>
    <resultType>hexadecimal</resultType>
    <resultfieldName>Checksum_FlagChanges</resultfieldName>
    <attributes/>
    <GUI>
      <xloc>7392</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Add value fields changing sequence</name>
    <type>FieldsChangeSequence</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>INDIVIDUAL_ID</name>
      </field>
    </fields>
    <increment>1</increment>
    <resultfieldName>Priority</resultfieldName>
    <start>1</start>
    <attributes/>
    <GUI>
      <xloc>3230</xloc>
      <yloc>672</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Add value fields changing sequence 2</name>
    <type>FieldsChangeSequence</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>POSITION_CODE</name>
      </field>
    </fields>
    <increment>1</increment>
    <resultfieldName>Priority</resultfieldName>
    <start>1</start>
    <attributes/>
    <GUI>
      <xloc>4336</xloc>
      <yloc>784</yloc>
    </GUI>
  </transform>
  <transform>
    <name>BPL_HR_EMPLOYEE_POSITION_DIM</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>EDW_HR</connection>
    <execute_each_row>N</execute_each_row>
    <limit>0</limit>
    <sql>SELECT
  EMPLOYEE_POSITION_KEY
, INDIVIDUAL_ID
, EMPLOYEE_POSITION_EFFECTIVE_DT
, POSITION_CODE
, POSITION_NAME
, POSITION_EXPIRY_DATE
, LOCATION_CODE
, LOCATION_NAME
, JOB_NUMBER
, JOB_NAME
, POSITION_TYPE_CODE
, POSITION_TYPE_NAME
, REPORT_TO_POSITION_CODE
, REPORT_TO_POSITION_NAME
, REPORT_TO_ORG_TYPE
, REPORT_TO_EMPLOYEE_NAME
, AFFILIATION_GROUP_CODE
, REPLACE_ORGANIZATION_CODE
, ACTING_POSITION_ADD_AMOUNT
, BENEFIT_GROUP_CODE
, REASON_CODE
, PERMANENT_INDICATOR
, FULL_TIME_INDICATOR
, FULL_TIME_PERCENT
, EXPIRY_DATE
, TRIAL_END_DATE
, CONTRACT_END_DATE
, EMPLOYEE_TYPE_CODE
, TAX_PROVINCE_CODE
, DISTRICT_BENEFIT_INDICATOR
, PENSION_EARN_INDICATOR
, PENSION_SERVICE_INDICATOR
, CREATE_DATE
, UPDATE_DATE
, CURRENT_RECORD_INDICATOR
, ASSIGNMENT_TYPE
, VIP_CREATE_DATE
, INDIVIDUAL_ENTITY_KEY
, REPORT_TO_EFFECTIVE_DATE
, RESEARCH_COMMENT
, PERSONAL_SERVICE_OFFICE_CODE
FROM HR_READER.BPL_HR_EMPLOYEE_POSITION_DIM
where REPORT_TO_EFFECTIVE_DATE is not null</sql>
    <variables_active>N</variables_active>
    <attributes/>
    <GUI>
      <xloc>1712</xloc>
      <yloc>672</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Changed/ new records</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compare>
      <condition>
        <conditions>
</conditions>
        <function>IS NULL</function>
        <leftvalue>Checksum_FlagChanges_In_SF</leftvalue>
        <negated>N</negated>
        <operator>-</operator>
      </condition>
    </compare>
    <send_true_to>Get system info</send_true_to>
    <attributes/>
    <GUI>
      <xloc>7808</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Current Employee Status</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>INDIVIDUAL_ID</field>
        <name>INDIVIDUAL_ID</name>
      </key>
      <key>
        <condition>=</condition>
        <field>CURRENT_RECORD_INDICATOR</field>
        <name>LOOKUP_STATUS_REASON_CODE_CURRENT</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_EMPLOYEE_STATUS</table>
      <value>
        <name>STATUS_REASON_CODE</name>
        <rename>STATUS_REASON_CODE_CURRENT</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>3483</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Dummy (do nothing) 2</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <GUI>
      <xloc>5728</xloc>
      <yloc>896</yloc>
    </GUI>
  </transform>
  <transform>
    <name>EDW_HR_EMPLOYEE_POSITION</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>EDW_HR</connection>
    <execute_each_row>N</execute_each_row>
    <limit>0</limit>
    <sql>SELECT
  POSITION_ENTITY_ID
, INDIVIDUAL_ENTITY_ID
, INDIVIDUAL_ID
, EMPLOYEE_POSITION_EFFECTIVE_DT
, POSITION_CODE
, AUDIT_SEQUENCE
, ASSIGNMENT_TYPE
, REPLACE_ORGANIZATION_CODE
, ACTING_POSITION_ADD_AMOUNT
, BENEFIT_GROUP_CODE
, REASON_CODE
, PERMANENT_INDICATOR
, FULL_TIME_INDICATOR
, FULL_TIME_PERCENT
, EXPIRY_DATE
, TRIAL_END_DATE
, CONTRACT_END_DATE
, EMPLOYEE_TYPE_CODE
, TAX_PROVINCE_CODE
, DISTRICT_BENEFIT_INDICATOR
, PENSION_EARN_INDICATOR
, PENSION_SERVICE_INDICATOR
, EMPLORERS_TAX_ACCOUNT_NUMBER
, INTERNAL_MAIL_CODE
, SORT_CODE
, COMMENTS
, UPDATE_TYPE
, CREA_TS
, LAST_UPD_TS
, CURRENT_RECORD_INDICATOR
, CREATE_DATE
, UPDATE_DATE
FROM HR_READER.EDW_HR_EMPLOYEE_POSITION
</sql>
    <variables_active>N</variables_active>
    <attributes/>
    <GUI>
      <xloc>1712</xloc>
      <yloc>784</yloc>
    </GUI>
  </transform>
  <transform>
    <name>EMPLOYEEEMAILADDRESS</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>PDB</connection>
    <execute_each_row>N</execute_each_row>
    <limit>0</limit>
    <sql>-- This query retrieves the latest email address for each ENID where VALIDID=10. If there are multiple records per ENID, it gives priority to the EMAILADDRESSLABEL "Primary" over "Personal".

SELECT 
  ENID, 
  -- Select the first email address per ENID ordered by EMAILADDRESSLABEL in descending order (i.e., "Primary" is higher than "Personal")
  MAX(EMAILADDRESS) KEEP (DENSE_RANK FIRST ORDER BY EMAILADDRESSLABEL DESC) AS EMAILADDRESS
FROM 
  PDB.EMPLOYEEEMAILADDRESS
WHERE 
  -- Only consider records where VALIDID = 10
  VALIDID = 10
  AND EVSQN = (
    -- Retrieve the highest EVSQN value for each ENID where VALIDID=10
    SELECT 
      MAX(EVSQN) 
    FROM 
      PDB.EMPLOYEEEMAILADDRESS 
    WHERE 
      ENID = PDB.EMPLOYEEEMAILADDRESS.ENID 
      AND VALIDID = 10
  )
GROUP BY 
  -- Group the results by ENID to return one row per ENID
  ENID
</sql>
    <variables_active>N</variables_active>
    <attributes/>
    <GUI>
      <xloc>1712</xloc>
      <yloc>912</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Employee</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>INDIVIDUAL_ID</field>
        <name>INDIVIDUAL_ID</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_EMPLOYEE</table>
      <value>
        <name>INDIVIDUAL_ID</name>
        <rename>Employee_ID</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>ORIGIONAL_HIRE_DATE</name>
        <rename>OriginalHireDate</rename>
        <trim_type>none</trim_type>
        <type>Date</type>
      </value>
      <value>
        <name>LAST_HIRE_DATE</name>
        <rename>LastHireDate</rename>
        <trim_type>none</trim_type>
        <type>Date</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>2471</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Employee 2</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <connection>MSSQL_RFSDW</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>INDIVIDUAL_ID</field>
        <name>INDIVIDUAL_ID</name>
      </key>
      <schema>edwhr</schema>
      <table>EDW_HR_EMPLOYEE</table>
      <value>
        <name>INDIVIDUAL_ID</name>
        <rename>Employee_ID</rename>
        <type>String</type>
      </value>
      <value>
        <name>ORIGIONAL_HIRE_DATE</name>
        <rename>OriginalHireDate</rename>
        <type>Date</type>
      </value>
      <value>
        <name>LAST_HIRE_DATE</name>
        <rename>LastHireDate</rename>
        <type>Date</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>2384</xloc>
      <yloc>352</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Employee Position</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>CURRENT_RECORD_INDICATOR</field>
        <name>LOOKUP_STATUS_POSITION_CURRENT</name>
      </key>
      <key>
        <condition>=</condition>
        <field>INDIVIDUAL_ID</field>
        <name>INDIVIDUAL_ID</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_EMPLOYEE_POSITION</table>
      <value>
        <name>ASSIGNMENT_TYPE</name>
        <rename>AssignmentType_Position</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>BENEFIT_GROUP_CODE</name>
        <rename>BenefitGroupCode_Position</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>REASON_CODE</name>
        <rename>ReasonCode_Position</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>PERMANENT_INDICATOR</name>
        <rename>PermanentIndicator_Position</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <name>FULL_TIME_INDICATOR</name>
        <rename>FullTimeIndicator_Position</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <name>FULL_TIME_PERCENT</name>
        <rename>FullTimePercent_Position</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <name>EMPLOYEE_TYPE_CODE</name>
        <rename>EmployeeTypeCode_Position</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <name>TRIAL_END_DATE</name>
        <rename>TrialEndDate_Position</rename>
        <trim_type>none</trim_type>
        <type>Date</type>
      </value>
      <value>
        <name>UPDATE_TYPE</name>
        <rename>UpdateType_Position</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>POSITION_CODE</name>
        <rename>PositionCode</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>2724</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Employee Status Reason</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>STATUS_REASON_CODE</field>
        <name>STATUS_REASON_CODE_CURRENT</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_STATUS_REASON</table>
      <value>
        <name>STATUS_REASON_TYPE</name>
        <rename>STATUS_REASON_TYPE_CURRENT</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>ENGLISH_NAME</name>
        <rename>STATUS_REASON_CURRENT_ENGLISH</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>EXPLANATION_ONE</name>
        <rename>STATUS_REASON_EXPLANATION_ONE_CURRENT</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>3736</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Employee Type</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>MSSQL_RFSDW_Azure__ReplaceLater</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>EmployeeType_ID</field>
        <name>EmployeeTypeCode_Position</name>
      </key>
      <schema>edwhr</schema>
      <table>EDW_HR_EMPLOYEE_TYPE</table>
      <value>
        <name>EmployeeType_Text</name>
        <rename>EmployeeType_Text</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>EmployeeType_Explanation</name>
        <rename>EmployeeType_Explanation</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>3989</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>EmploymentCategory</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
var IsFullTime = null;
var IsPermanent = null;
var EmploymentStatus = null;
var EmploymentStatus_NoOfRules = 0;
var EmploymentStatus_SortOrder = 99999;


//Is Full Time?
switch (true) {
	case FullTimeIndicator_Position == 0:
		IsFullTime = "No"
		break;
	case FullTimeIndicator_Position == 1:
		IsFullTime = "Yes"
		break;
	default:
		IsFullTime = "***Undefined***"
}
	

//Is Permanent?
switch (true) {
	case PermanentIndicator_Position == 0:
		IsPermanent = "No"
		break;
	case PermanentIndicator_Position == 1:
		IsPermanent = "Yes"
		break;
	default:
		IsPermanent = "***Undefined***"
}


//From here on calculate EmploymentStatus

//Permanent Full-time
if (
		IsFullTime == "Yes"
		&amp;&amp; IsPermanent == "Yes"
		&amp;&amp; EmployeeTypeCode_Position != "M"
		&amp;&amp; EmployeeTypeCode_Position != "K"
		&amp;&amp; EmployeeTypeCode_Position != "Z"
		&amp;&amp; COMPENSATION_GROUP_CODE != "DUM"
		&amp;&amp; IsOnLeaveOfAbsence == "No"
		&amp;&amp; IsTerminated == "No"
) {
		EmploymentStatus = "Permanent Full-Time"
		//If NoOfRules > 1, then rules are overlapping. If 0, then record not covered by any rules.
		EmploymentStatus_NoOfRules = EmploymentStatus_NoOfRules + 1
}


//Permanent Part-time
if (
		IsFullTime == "No"
		&amp;&amp; IsPermanent == "Yes"
		&amp;&amp; EmployeeTypeCode_Position != "C"
		&amp;&amp; EmployeeTypeCode_Position != "M"
		&amp;&amp; EmployeeTypeCode_Position != "K"
		&amp;&amp; EmployeeTypeCode_Position != "Z"
		&amp;&amp; COMPENSATION_GROUP_CODE != "DUM"
		&amp;&amp; IsOnLeaveOfAbsence == "No"
		&amp;&amp; IsTerminated == "No"
) {
		EmploymentStatus = "Permanent Part-Time"
		//If NoOfRules > 1, then rules are overlapping. If 0, then record not covered by any rules.
		EmploymentStatus_NoOfRules = EmploymentStatus_NoOfRules + 1
}


//Casual
if (
		IsFullTime == "No"
		&amp;&amp; IsPermanent == "Yes"
		&amp;&amp; EmployeeTypeCode_Position == "C"
		&amp;&amp; FullTimePercent_Position == 1
		&amp;&amp; COMPENSATION_GROUP_CODE != "DUM"
		&amp;&amp; IsOnLeaveOfAbsence == "No"
		&amp;&amp; IsTerminated == "No"
) {
		EmploymentStatus = "Casual"
		//If NoOfRules > 1, then rules are overlapping. If 0, then record not covered by any rules.
		EmploymentStatus_NoOfRules = EmploymentStatus_NoOfRules + 1
}


//Temporary
if (
		(
			IsFullTime == "No" 
			|| IsFullTime == "Yes"
		)
		&amp;&amp; IsPermanent == "No"
		&amp;&amp; EmployeeTypeCode_Position != "M"
		&amp;&amp; EmployeeTypeCode_Position != "K"
		&amp;&amp; EmployeeTypeCode_Position != "Z"
		&amp;&amp; COMPENSATION_GROUP_CODE != "DUM"
		&amp;&amp; IsOnLeaveOfAbsence == "No"
		&amp;&amp; IsTerminated == "No"
) {
		EmploymentStatus = "Temporary"
		//If NoOfRules > 1, then rules are overlapping. If 0, then record not covered by any rules.
		EmploymentStatus_NoOfRules = EmploymentStatus_NoOfRules + 1
}


//Use this column in the data model to set the "Sort by" column.
switch (true) {

	case EmploymentStatus == "Permanent Full-Time":
		EmploymentStatus_SortOrder = 10
		break;

	case EmploymentStatus == "Permanent Part-Time":
		EmploymentStatus_SortOrder = 20
		break;
	
	case EmploymentStatus == "Temporary":
		EmploymentStatus_SortOrder = 30
		break;

	case EmploymentStatus == "Casual":
		EmploymentStatus_SortOrder = 40
		break;


	default:
				EmploymentStatus_SortOrder = 99
}



</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>IsFullTime</name>
        <rename>IsFullTime</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>IsPermanent</name>
        <rename>IsPermanent</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>EmploymentStatus</name>
        <rename>EmploymentStatus</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>EmploymentStatus_NoOfRules</name>
        <rename>EmploymentStatus_NoOfRules</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>EmploymentStatus_SortOrder</name>
        <rename>EmploymentStatus_SortOrder</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>6656</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Filter rows</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compare>
      <condition>
        <conditions>
</conditions>
        <function>=</function>
        <leftvalue>Priority</leftvalue>
        <negated>N</negated>
        <operator>-</operator>
        <value>
          <isnull>N</isnull>
          <length>-1</length>
          <mask>#</mask>
          <name>constant</name>
          <precision>0</precision>
          <text>1</text>
          <type>Integer</type>
        </value>
      </condition>
    </compare>
    <send_true_to>Select values 4</send_true_to>
    <attributes/>
    <GUI>
      <xloc>3989</xloc>
      <yloc>672</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Filter rows 2</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compare>
      <condition>
        <conditions>
</conditions>
        <function>=</function>
        <leftvalue>Priority</leftvalue>
        <negated>N</negated>
        <operator>-</operator>
        <value>
          <isnull>N</isnull>
          <length>-1</length>
          <mask>#</mask>
          <name>constant</name>
          <precision>0</precision>
          <text>1</text>
          <type>Integer</type>
        </value>
      </condition>
    </compare>
    <send_true_to>Select values 5</send_true_to>
    <attributes/>
    <GUI>
      <xloc>4656</xloc>
      <yloc>784</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Find ENID by EmployeeID</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>PDB</connection>
    <execute_each_row>N</execute_each_row>
    <limit>0</limit>
    <sql>SELECT  m.ENID
      , m.EVSQN
      , m.EMPLOYEEIDDESC
      , m.VALIDID
      , m.VALIDDESC

  FROM PDB.VFSTDB_EMPLOYEEID m
  INNER JOIN (
  SELECT ENID
      ,max(EVSQN) as MAXEVSQN
  FROM PDB.VFSTDB_EMPLOYEEID 
  group by ENID
  ) t
  ON t.MAXEVSQN = m.EVSQN and m.ENID = t.ENID</sql>
    <variables_active>N</variables_active>
    <attributes/>
    <GUI>
      <xloc>5472</xloc>
      <yloc>352</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Find ENID by EmployeeID ori</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>MSSQL_RFSDW</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>EMPLOYEEIDDESC</field>
        <name>INDIVIDUAL_ID</name>
      </key>
      <value>
        <name>ENID</name>
        <rename>ENID</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>5008</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Get system info</name>
    <type>SystemInfo</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>LastUpdate</name>
        <type>system date (fixed)</type>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>7968</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>HR Job Detail</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>JOB_NUMBER</field>
        <name>JobNumber</name>
      </key>
      <key>
        <condition>=</condition>
        <field>CURRENT_RECORD_INDICATOR</field>
        <name>LOOKUP_HR_JOB_DETAIL_CURRENT</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_JOB_DETAIL</table>
      <value>
        <name>JOB_DETAIL_NAME_ENGLISH</name>
        <rename>JOB_DETAIL_NAME_ENGLISH</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>COMPENSATION_GROUP_CODE</name>
        <rename>COMPENSATION_GROUP_CODE</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>3230</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>HR LOCATION</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>LOCATION_CODE</field>
        <name>LOCATION_CODE</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_LOCATION</table>
      <value>
        <name>ENGLISH_NAME</name>
        <rename>LOCATION_ENGLISH_NAME</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>4495</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>HR Position</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>POSITION_CODE</field>
        <name>PositionCode</name>
      </key>
      <key>
        <condition>=</condition>
        <field>CURRENT_RECORD_INDICATOR</field>
        <name>LOOKUP_HR_POSITION_CURRENT</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_POSITION</table>
      <value>
        <name>JOB_NUMBER</name>
        <rename>JobNumber</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>POSITION_NAME_ONE</name>
        <rename>POSITION_NAME_ONE</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>POSITION_NAME_TWO</name>
        <rename>POSITION_NAME_TWO</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>LOCATION_CODE</name>
        <rename>LOCATION_CODE</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>LOCATION_ENTITY_ID</name>
        <rename>LOCATION_ENTITY_ID</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>2977</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>HR Status Reason Type</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>STATUS_REASON_TYPE</field>
        <name>STATUS_REASON_TYPE_CURRENT</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_STATUS_REASON_TYPE</table>
      <value>
        <name>ENGLISH_NAME</name>
        <rename>STATUS_REASON_TYPE_ENGLISH</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>4242</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>If field value is null</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>POSITION_NAME_ONE</name>
        <set_empty_string>N</set_empty_string>
        <value>***Missing***</value>
      </field>
      <field>
        <name>POSITION_NAME_TWO</name>
        <set_empty_string>N</set_empty_string>
        <value>***Missing***</value>
      </field>
      <field>
        <name>JOB_DETAIL_NAME_ENGLISH</name>
        <set_empty_string>N</set_empty_string>
        <value>***Missing***</value>
      </field>
    </fields>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
</valuetypes>
    <attributes/>
    <GUI>
      <xloc>6016</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Individual</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>EDW_HR</connection>
    <execute_each_row>N</execute_each_row>
    <limit>0</limit>
    <sql>SELECT
  INDIVIDUAL_ENTITY_ID
, INDIVIDUAL_ID
, SOCIAL_INSURANCE_NUMBER
, SALUTATION_CODE
, SURNAME
, SOCIAL_SECURITY_NUMBER
, FIRST_NAME
, INITIALS
, PREVIOUS_SURNAME
, USUAL_FIRST_NAME
, DATE_OF_BIRTH
, COMMUNICATION_LANGUAGE_CODE
, GENDER_CODE
, CANADIAN_CITIZEN_INDICATOR
, OTHER_CITIZEN_COUNTRY_CODE
, APPLICATION_LAST_ACTIVITY_DATE
, DEATH_DATE
, SPOUSE_INDIVIDUAL_ID
, CENSUS_METROPOLITAN_A_CODE
, SMOKER_INDICATOR
, MARITAL_STATUS_CODE
, PHOTO_PATH
, CANADIAN_EMPLOYMENT_CENTRE_CD
, CARE_OF_CODE
, CARE_OF_NAME
, INDIVIDUAL_EFFECTIVE_DATE
, INDIVIDUAL_EXPIRY_DATE
, CREA_TS
, LAST_UPD_TS
, CURRENT_RECORD_INDICATOR
, CREATE_DATE
, UPDATE_DATE
FROM HR_READER.EDW_HR_INDIVIDUAL
--WHERE CREATE_DATE >= TRUNC(SYSDATE) - 7 OR UPDATE_DATE >= TRUNC(SYSDATE) - 7


</sql>
    <variables_active>N</variables_active>
    <attributes/>
    <GUI>
      <xloc>1712</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Insert / update</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>20</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <commit>1000</commit>
    <connection>MSSQL_RFSDW</connection>
    <lookup>
      <key>
        <condition>=</condition>
        <field>INDIVIDUAL_ID</field>
        <name>INDIVIDUAL_ID</name>
      </key>
      <schema>bihrdim</schema>
      <table>Individual</table>
      <value>
        <name>APPLICATION_LAST_ACTIVITY_DATE</name>
        <rename>APPLICATION_LAST_ACTIVITY_DATE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>AssignmentType_Position</name>
        <rename>AssignmentType_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>BenefitGroupCode_Position</name>
        <rename>BenefitGroupCode_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>CANADIAN_CITIZEN_INDICATOR</name>
        <rename>CANADIAN_CITIZEN_INDICATOR</rename>
        <update>Y</update>
      </value>
      <value>
        <name>COMMUNICATION_LANGUAGE_CODE</name>
        <rename>COMMUNICATION_LANGUAGE_CODE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>COMPENSATION_GROUP_CODE</name>
        <rename>COMPENSATION_GROUP_CODE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>CREATE_DATE</name>
        <rename>CREATE_DATE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>CREA_TS</name>
        <rename>CREA_TS</rename>
        <update>Y</update>
      </value>
      <value>
        <name>CURRENT_RECORD_INDICATOR</name>
        <rename>CURRENT_RECORD_INDICATOR</rename>
        <update>Y</update>
      </value>
      <value>
        <name>DATE_OF_BIRTH</name>
        <rename>DATE_OF_BIRTH</rename>
        <update>Y</update>
      </value>
      <value>
        <name>ENID</name>
        <rename>ENID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Email</name>
        <rename>Email</rename>
        <update>Y</update>
      </value>
      <value>
        <name>EmployeeTypeCode_Position</name>
        <rename>EmployeeTypeCode_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>EmployeeType_Explanation</name>
        <rename>EmployeeType_Explanation</rename>
        <update>Y</update>
      </value>
      <value>
        <name>EmployeeType_Text</name>
        <rename>EmployeeType_Text</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Employee_FirstLastName</name>
        <rename>Employee_FirstLastName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Employee_FirstName</name>
        <rename>Employee_FirstName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Employee_ID</name>
        <rename>Employee_ID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Employee_LastFirstName</name>
        <rename>Employee_LastFirstName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Employee_LastName</name>
        <rename>Employee_LastName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>EmploymentStatus</name>
        <rename>EmploymentStatus</rename>
        <update>Y</update>
      </value>
      <value>
        <name>EmploymentStatus_NoOfRules</name>
        <rename>EmploymentStatus_NoOfRules</rename>
        <update>Y</update>
      </value>
      <value>
        <name>EmploymentStatus_SortOrder</name>
        <rename>EmploymentStatus_SortOrder</rename>
        <update>Y</update>
      </value>
      <value>
        <name>FIRST_NAME</name>
        <rename>FIRST_NAME</rename>
        <update>Y</update>
      </value>
      <value>
        <name>FullTimeIndicator_Position</name>
        <rename>FullTimeIndicator_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>FullTimePercent_Position</name>
        <rename>FullTimePercent_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Gender</name>
        <rename>Gender</rename>
        <update>Y</update>
      </value>
      <value>
        <name>INDIVIDUAL_EFFECTIVE_DATE</name>
        <rename>INDIVIDUAL_EFFECTIVE_DATE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>INDIVIDUAL_EXPIRY_DATE</name>
        <rename>INDIVIDUAL_EXPIRY_DATE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>INDIVIDUAL_ID</name>
        <rename>INDIVIDUAL_ID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>INITIALS</name>
        <rename>INITIALS</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IsEmployee</name>
        <rename>IsEmployee</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IsFullTime</name>
        <rename>IsFullTime</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IsOnLeaveOfAbsence</name>
        <rename>IsOnLeaveOfAbsence</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IsPermanent</name>
        <rename>IsPermanent</rename>
        <update>Y</update>
      </value>
      <value>
        <name>IsTerminated</name>
        <rename>IsTerminated</rename>
        <update>Y</update>
      </value>
      <value>
        <name>JOB_DETAIL_NAME_ENGLISH</name>
        <rename>JOB_DETAIL_NAME_ENGLISH</rename>
        <update>Y</update>
      </value>
      <value>
        <name>JobNumber</name>
        <rename>JobNumber</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LAST_UPD_TS</name>
        <rename>LAST_UPD_TS</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LOCATION_CODE</name>
        <rename>LOCATION_CODE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LOCATION_ENGLISH_NAME</name>
        <rename>LOCATION_ENGLISH_NAME</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LOOKUP_HR_JOB_DETAIL_CURRENT</name>
        <rename>LOOKUP_HR_JOB_DETAIL_CURRENT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LOOKUP_HR_POSITION_CURRENT</name>
        <rename>LOOKUP_HR_POSITION_CURRENT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LOOKUP_STATUS_POSITION_CURRENT</name>
        <rename>LOOKUP_STATUS_POSITION_CURRENT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LOOKUP_STATUS_REASON_CODE_CURRENT</name>
        <rename>LOOKUP_STATUS_REASON_CODE_CURRENT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LastHireDate</name>
        <rename>LastHireDate</rename>
        <update>Y</update>
      </value>
      <value>
        <name>OTHER_CITIZEN_COUNTRY_CODE</name>
        <rename>OTHER_CITIZEN_COUNTRY_CODE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>OriginalHireDate</name>
        <rename>OriginalHireDate</rename>
        <update>Y</update>
      </value>
      <value>
        <name>POSITION_NAME_ONE</name>
        <rename>POSITION_NAME_ONE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>POSITION_NAME_TWO</name>
        <rename>POSITION_NAME_TWO</rename>
        <update>Y</update>
      </value>
      <value>
        <name>PermanentIndicator_Position</name>
        <rename>PermanentIndicator_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>PositionCode</name>
        <rename>PositionCode</rename>
        <update>Y</update>
      </value>
      <value>
        <name>ReasonCode_Position</name>
        <rename>ReasonCode_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>ReportTo_LastName</name>
        <rename>ReportTo_LastName</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Report_To_Individual_ID</name>
        <rename>Report_To_Individual_ID</rename>
        <update>Y</update>
      </value>
      <value>
        <name>SALUTATION_CODE</name>
        <rename>SALUTATION_CODE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>STATUS_REASON_CODE_CURRENT</name>
        <rename>STATUS_REASON_CODE_CURRENT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>STATUS_REASON_CURRENT_ENGLISH</name>
        <rename>STATUS_REASON_CURRENT_ENGLISH</rename>
        <update>Y</update>
      </value>
      <value>
        <name>STATUS_REASON_EXPLANATION_ONE_CURRENT</name>
        <rename>STATUS_REASON_EXPLANATION_ONE_CURRENT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>STATUS_REASON_TYPE_CURRENT</name>
        <rename>STATUS_REASON_TYPE_CURRENT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>STATUS_REASON_TYPE_ENGLISH</name>
        <rename>STATUS_REASON_TYPE_ENGLISH</rename>
        <update>Y</update>
      </value>
      <value>
        <name>SURNAME</name>
        <rename>SURNAME</rename>
        <update>Y</update>
      </value>
      <value>
        <name>TrialEndDate_Position</name>
        <rename>TrialEndDate_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>UPDATE_DATE</name>
        <rename>UPDATE_DATE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>USUAL_FIRST_NAME</name>
        <rename>USUAL_FIRST_NAME</rename>
        <update>Y</update>
      </value>
      <value>
        <name>UpdateType_Position</name>
        <rename>UpdateType_Position</rename>
        <update>Y</update>
      </value>
      <value>
        <name>LastUpdate</name>
        <rename>LastUpdate</rename>
        <update>Y</update>
      </value>
      <value>
        <name>Checksum_FlagChanges</name>
        <rename>Checksum_FlagChanges</rename>
        <update>N</update>
      </value>
    </lookup>
    <update_bypassed>N</update_bypassed>
    <attributes/>
    <GUI>
      <xloc>8480</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Is Employee?</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>EmploymentStatus//Script here

//This rule is likely not correct
var IsEmployee = null;



//if (Employee_ID !== null) {
//IsEmployee = 'Yes'
//} else {
//IsEmployee = 'No'
//}


if (EmploymentStatus == null) {
	IsEmployee = 'No'
} else {
	IsEmployee = 'Yes'
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>IsEmployee</name>
        <rename>IsEmployee</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>6816</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Lookup Criteria</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here


//All employee status history is tracked in table EDW_HR_EMPLOYEE_STATUS. Field CURRENT_RECORD_INDICATOR shows current (1) and past (0) records.
var LOOKUP_STATUS_REASON_CODE_CURRENT = 1

var LOOKUP_STATUS_POSITION_CURRENT = 1

var LOOKUP_HR_POSITION_CURRENT = 1

var LOOKUP_HR_JOB_DETAIL_CURRENT = 1</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>LOOKUP_STATUS_REASON_CODE_CURRENT</name>
        <rename>LOOKUP_STATUS_REASON_CODE_CURRENT</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>LOOKUP_STATUS_POSITION_CURRENT</name>
        <rename>LOOKUP_STATUS_POSITION_CURRENT</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>LOOKUP_HR_POSITION_CURRENT</name>
        <rename>LOOKUP_HR_POSITION_CURRENT</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>LOOKUP_HR_JOB_DETAIL_CURRENT</name>
        <rename>LOOKUP_HR_JOB_DETAIL_CURRENT</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1965</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Lookup Existing ChangeFlag</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>MSSQL_RFSDW</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>Checksum_FlagChanges</field>
        <name>Checksum_FlagChanges</name>
      </key>
      <schema>bihrdim</schema>
      <table>Individual</table>
      <value>
        <name>Checksum_FlagChanges</name>
        <rename>Checksum_FlagChanges_In_SF</rename>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>7568</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Modified JavaScript value 2</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here

var Employee_FirstName = null;
var Employee_LastName = null;
var Employee_FirstLastName = null;
var Employee_LastFirstName = null;
var IsOnLeaveOfAbsence = null;
var IsTerminated = null;

Employee_FirstName = initCap(trim(FIRST_NAME));
Employee_LastName = initCap(trim(SURNAME));
Employee_FirstLastName = Employee_FirstName.concat(" ").concat(Employee_LastName);
Employee_LastFirstName = Employee_LastName.concat(", ").concat(Employee_FirstName);

//Leave of Absence
if (
	substr(STATUS_REASON_CODE_CURRENT,0,1) == "L"
	) {
	IsOnLeaveOfAbsence = "Yes"
		} else {
	IsOnLeaveOfAbsence = "No"
		}

//Terminated
if (
	substr(STATUS_REASON_CODE_CURRENT,0,1) == "T"
	) {
	IsTerminated = "Yes"
		} else {
	IsTerminated = "No"
		}


</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>Employee_FirstName</name>
        <rename>Employee_FirstName</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>Employee_LastName</name>
        <rename>Employee_LastName</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>Employee_FirstLastName</name>
        <rename>Employee_FirstLastName</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>Employee_LastFirstName</name>
        <rename>Employee_LastFirstName</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>IsOnLeaveOfAbsence</name>
        <rename>IsOnLeaveOfAbsence</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>IsTerminated</name>
        <rename>IsTerminated</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>6432</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Replace in string</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>GENDER_CODE</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>Male</replace_by_string>
        <replace_string>M</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>Y</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>GENDER_CODE</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>Female</replace_by_string>
        <replace_string>F</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>Y</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>LOCATION_ENGLISH_NAME</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string> TGH</replace_by_string>
        <replace_string> Tgh</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>LOCATION_ENGLISH_NAME</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string> TWH</replace_by_string>
        <replace_string> Twh</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>LOCATION_ENGLISH_NAME</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string> PMH</replace_by_string>
        <replace_string> Pmh</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>LOCATION_ENGLISH_NAME</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>SHSS</replace_by_string>
        <replace_string>Shss</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>7168</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>ReportTo_Details</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <connection>EDW_HR</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>INDIVIDUAL_ID</field>
        <name>ReportTo_Individual_ID</name>
      </key>
      <schema>HR_READER</schema>
      <table>EDW_HR_INDIVIDUAL</table>
      <value>
        <name>FIRST_NAME</name>
        <rename>ReportTo_FirstName</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <name>SURNAME</name>
        <rename>ReportTo_LastName</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>5264</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>INDIVIDUAL_ID</name>
      </field>
      <field>
        <name>SALUTATION_CODE</name>
      </field>
      <field>
        <name>SURNAME</name>
      </field>
      <field>
        <name>FIRST_NAME</name>
      </field>
      <field>
        <name>INITIALS</name>
      </field>
      <field>
        <name>USUAL_FIRST_NAME</name>
      </field>
      <field>
        <name>DATE_OF_BIRTH</name>
      </field>
      <field>
        <name>COMMUNICATION_LANGUAGE_CODE</name>
      </field>
      <field>
        <name>GENDER_CODE</name>
      </field>
      <field>
        <name>CANADIAN_CITIZEN_INDICATOR</name>
      </field>
      <field>
        <name>OTHER_CITIZEN_COUNTRY_CODE</name>
      </field>
      <field>
        <name>APPLICATION_LAST_ACTIVITY_DATE</name>
      </field>
      <field>
        <name>INDIVIDUAL_EFFECTIVE_DATE</name>
      </field>
      <field>
        <name>INDIVIDUAL_EXPIRY_DATE</name>
      </field>
      <field>
        <name>CREA_TS</name>
      </field>
      <field>
        <name>LAST_UPD_TS</name>
      </field>
      <field>
        <name>CURRENT_RECORD_INDICATOR</name>
      </field>
      <field>
        <name>CREATE_DATE</name>
      </field>
      <field>
        <name>UPDATE_DATE</name>
      </field>
      <field>
        <name>LOOKUP_STATUS_REASON_CODE_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_STATUS_POSITION_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_HR_POSITION_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_HR_JOB_DETAIL_CURRENT</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>2218</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>APPLICATION_LAST_ACTIVITY_DATE</name>
      </field>
      <field>
        <name>AssignmentType_Position</name>
      </field>
      <field>
        <name>BenefitGroupCode_Position</name>
      </field>
      <field>
        <name>CANADIAN_CITIZEN_INDICATOR</name>
      </field>
      <field>
        <name>COMMUNICATION_LANGUAGE_CODE</name>
      </field>
      <field>
        <name>COMPENSATION_GROUP_CODE</name>
      </field>
      <field>
        <name>CREATE_DATE</name>
      </field>
      <field>
        <name>CREA_TS</name>
      </field>
      <field>
        <name>CURRENT_RECORD_INDICATOR</name>
      </field>
      <field>
        <name>DATE_OF_BIRTH</name>
      </field>
      <field>
        <name>ENID</name>
      </field>
      <field>
        <name>Email</name>
      </field>
      <field>
        <name>EmployeeTypeCode_Position</name>
      </field>
      <field>
        <name>EmployeeType_Explanation</name>
      </field>
      <field>
        <name>EmployeeType_Text</name>
      </field>
      <field>
        <name>Employee_ID</name>
      </field>
      <field>
        <name>FIRST_NAME</name>
      </field>
      <field>
        <name>FullTimeIndicator_Position</name>
      </field>
      <field>
        <name>FullTimePercent_Position</name>
      </field>
      <field>
        <name>GENDER_CODE</name>
      </field>
      <field>
        <name>INDIVIDUAL_EFFECTIVE_DATE</name>
      </field>
      <field>
        <name>INDIVIDUAL_EXPIRY_DATE</name>
      </field>
      <field>
        <name>INDIVIDUAL_ID</name>
      </field>
      <field>
        <name>INITIALS</name>
      </field>
      <field>
        <name>JOB_DETAIL_NAME_ENGLISH</name>
      </field>
      <field>
        <name>JobNumber</name>
      </field>
      <field>
        <name>LAST_UPD_TS</name>
      </field>
      <field>
        <name>LOCATION_CODE</name>
      </field>
      <field>
        <name>LOCATION_ENGLISH_NAME</name>
      </field>
      <field>
        <name>LOOKUP_HR_JOB_DETAIL_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_HR_POSITION_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_STATUS_POSITION_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_STATUS_REASON_CODE_CURRENT</name>
      </field>
      <field>
        <name>LastHireDate</name>
      </field>
      <field>
        <name>OTHER_CITIZEN_COUNTRY_CODE</name>
      </field>
      <field>
        <name>OriginalHireDate</name>
      </field>
      <field>
        <name>POSITION_NAME_ONE</name>
      </field>
      <field>
        <name>POSITION_NAME_TWO</name>
      </field>
      <field>
        <name>PermanentIndicator_Position</name>
      </field>
      <field>
        <name>PositionCode</name>
      </field>
      <field>
        <name>ReasonCode_Position</name>
      </field>
      <field>
        <name>ReportTo_FirstName</name>
      </field>
      <field>
        <name>ReportTo_Individual_ID</name>
      </field>
      <field>
        <name>ReportTo_LastName</name>
      </field>
      <field>
        <name>SALUTATION_CODE</name>
      </field>
      <field>
        <name>STATUS_REASON_CODE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_CURRENT_ENGLISH</name>
      </field>
      <field>
        <name>STATUS_REASON_EXPLANATION_ONE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_TYPE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_TYPE_ENGLISH</name>
      </field>
      <field>
        <name>SURNAME</name>
      </field>
      <field>
        <name>TrialEndDate_Position</name>
      </field>
      <field>
        <name>UPDATE_DATE</name>
      </field>
      <field>
        <name>USUAL_FIRST_NAME</name>
      </field>
      <field>
        <name>UpdateType_Position</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>6208</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 3</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>APPLICATION_LAST_ACTIVITY_DATE</name>
      </field>
      <field>
        <name>AssignmentType_Position</name>
      </field>
      <field>
        <name>BenefitGroupCode_Position</name>
      </field>
      <field>
        <name>CANADIAN_CITIZEN_INDICATOR</name>
      </field>
      <field>
        <name>COMMUNICATION_LANGUAGE_CODE</name>
      </field>
      <field>
        <name>COMPENSATION_GROUP_CODE</name>
      </field>
      <field>
        <name>CREATE_DATE</name>
      </field>
      <field>
        <name>CREA_TS</name>
      </field>
      <field>
        <name>CURRENT_RECORD_INDICATOR</name>
      </field>
      <field>
        <name>DATE_OF_BIRTH</name>
      </field>
      <field>
        <name>ENID</name>
      </field>
      <field>
        <name>Email</name>
      </field>
      <field>
        <name>EmployeeTypeCode_Position</name>
      </field>
      <field>
        <name>EmployeeType_Explanation</name>
      </field>
      <field>
        <name>EmployeeType_Text</name>
      </field>
      <field>
        <name>Employee_FirstLastName</name>
      </field>
      <field>
        <name>Employee_FirstName</name>
      </field>
      <field>
        <name>Employee_ID</name>
      </field>
      <field>
        <name>Employee_LastFirstName</name>
      </field>
      <field>
        <name>Employee_LastName</name>
      </field>
      <field>
        <name>EmploymentStatus</name>
      </field>
      <field>
        <name>EmploymentStatus_NoOfRules</name>
      </field>
      <field>
        <name>EmploymentStatus_SortOrder</name>
      </field>
      <field>
        <name>FIRST_NAME</name>
      </field>
      <field>
        <name>FullTimeIndicator_Position</name>
      </field>
      <field>
        <name>FullTimePercent_Position</name>
      </field>
      <field>
        <name>GENDER_CODE</name>
        <rename>Gender</rename>
      </field>
      <field>
        <name>INDIVIDUAL_EFFECTIVE_DATE</name>
      </field>
      <field>
        <name>INDIVIDUAL_EXPIRY_DATE</name>
      </field>
      <field>
        <name>INDIVIDUAL_ID</name>
      </field>
      <field>
        <name>INITIALS</name>
      </field>
      <field>
        <name>IsEmployee</name>
      </field>
      <field>
        <name>IsFullTime</name>
      </field>
      <field>
        <name>IsOnLeaveOfAbsence</name>
      </field>
      <field>
        <name>IsPermanent</name>
      </field>
      <field>
        <name>IsTerminated</name>
      </field>
      <field>
        <name>JOB_DETAIL_NAME_ENGLISH</name>
      </field>
      <field>
        <name>JobNumber</name>
      </field>
      <field>
        <name>LAST_UPD_TS</name>
      </field>
      <field>
        <name>LOCATION_CODE</name>
      </field>
      <field>
        <name>LOCATION_ENGLISH_NAME</name>
      </field>
      <field>
        <name>LOOKUP_HR_JOB_DETAIL_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_HR_POSITION_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_STATUS_POSITION_CURRENT</name>
      </field>
      <field>
        <name>LOOKUP_STATUS_REASON_CODE_CURRENT</name>
      </field>
      <field>
        <name>LastHireDate</name>
      </field>
      <field>
        <name>OTHER_CITIZEN_COUNTRY_CODE</name>
      </field>
      <field>
        <name>OriginalHireDate</name>
      </field>
      <field>
        <name>POSITION_NAME_ONE</name>
      </field>
      <field>
        <name>POSITION_NAME_TWO</name>
      </field>
      <field>
        <name>PermanentIndicator_Position</name>
      </field>
      <field>
        <name>PositionCode</name>
      </field>
      <field>
        <name>ReasonCode_Position</name>
      </field>
      <field>
        <name>ReportTo_Individual_ID</name>
        <rename>Report_To_Individual_ID</rename>
      </field>
      <field>
        <name>ReportTo_LastName</name>
      </field>
      <field>
        <name>SALUTATION_CODE</name>
      </field>
      <field>
        <name>STATUS_REASON_CODE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_CURRENT_ENGLISH</name>
      </field>
      <field>
        <name>STATUS_REASON_EXPLANATION_ONE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_TYPE_CURRENT</name>
      </field>
      <field>
        <name>STATUS_REASON_TYPE_ENGLISH</name>
      </field>
      <field>
        <name>SURNAME</name>
      </field>
      <field>
        <name>TrialEndDate_Position</name>
      </field>
      <field>
        <name>UPDATE_DATE</name>
      </field>
      <field>
        <name>USUAL_FIRST_NAME</name>
      </field>
      <field>
        <name>UpdateType_Position</name>
      </field>
      <field>
        <name>LastUpdate</name>
      </field>
      <field>
        <name>Checksum_FlagChanges</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>8160</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 4</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>INDIVIDUAL_ID</name>
      </field>
      <field>
        <name>REPORT_TO_POSITION_CODE</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>4748</xloc>
      <yloc>672</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 5</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>INDIVIDUAL_ID</name>
        <rename>ReportTo_Individual_ID</rename>
      </field>
      <field>
        <name>POSITION_CODE</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>5008</xloc>
      <yloc>784</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Sort rows</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>INDIVIDUAL_ID</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>CURRENT_RECORD_INDICATOR</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>EXPIRY_DATE</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>2471</xloc>
      <yloc>672</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Sort rows 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>POSITION_CODE</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>CURRENT_RECORD_INDICATOR</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>AUDIT_SEQUENCE</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>EXPIRY_DATE</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>LAST_UPD_TS</name>
        <ascending>N</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>3904</xloc>
      <yloc>784</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Stream lookup</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Select values 4</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>INDIVIDUAL_ID</name>
        <field>INDIVIDUAL_ID</field>
      </key>
      <value>
        <name>REPORT_TO_POSITION_CODE</name>
        <rename>REPORT_TO_POSITION_CODE</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>4748</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Stream lookup 2</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Select values 5</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>REPORT_TO_POSITION_CODE</name>
        <field>POSITION_CODE</field>
      </key>
      <value>
        <name>ReportTo_Individual_ID</name>
        <rename>ReportTo_Individual_ID</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>5001</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Stream lookup 3</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Dummy (do nothing) 2</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>ENID</name>
        <field>ENID</field>
      </key>
      <value>
        <name>EMAILADDRESS</name>
        <rename>Email</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>5728</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Stream lookup 4</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Find ENID by EmployeeID</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>INDIVIDUAL_ID</name>
        <field>EMPLOYEEIDDESC</field>
      </key>
      <value>
        <name>ENID</name>
        <rename>ENID</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>5472</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform>
    <name>String operations</name>
    <type>StringOperations</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>STATUS_REASON_TYPE_ENGLISH</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
      <field>
        <in_stream_name>LOCATION_ENGLISH_NAME</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
      <field>
        <in_stream_name>STATUS_REASON_CURRENT_ENGLISH</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
      <field>
        <in_stream_name>SURNAME</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
      <field>
        <in_stream_name>FIRST_NAME</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
      <field>
        <in_stream_name>ReportTo_FirstName</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
      <field>
        <in_stream_name>ReportTo_LastName</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
      <field>
        <in_stream_name>Email</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
      <field>
        <in_stream_name>USUAL_FIRST_NAME</in_stream_name>
        <out_stream_name/>
        <trim_type>none</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>6976</xloc>
      <yloc>544</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes/>
</pipeline>
